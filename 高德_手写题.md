
## 一、手写 `promisify`

```js

var fs = require('fs');
fs.readFile('input.txt', function (err, data) {
  if (err) {
    return console.error(err);
  }
  console.log('异步读取: ' + data.toString());
});

function promisify(fn) {
  return function (...args) {
    return new Promise((resolve, reject) => {
      fn(...args, (err, data) => {
        if (err) reject(err);
        else resolve(data);
      });
    });
  };
}

promisify(fs.readFile)('input.txt')
  .then((data) => {
    console.log('异步读取: ' + data.toString());
  })
  .catch((err) => {
    console.error(err);
  });
```

---

## 二、手写 `Array.prototype.reduce`

```js
Array.prototype.reduce = function (callback, initialValue) {
  let arr = this;
  let acc;
  let start = 0;

  if (arguments.length > 1) {
    acc = initialValue;
  } else {
    acc = arr[0];
    start = 1;
  }

  for (let i = start; i < arr.length; i++) {
    acc = callback(acc, arr[i], i, arr);
  }

  return acc;
};
```

---

## 三、手写支持链式调用的 `find`

```js
function find(data) {
  return {
    value: data,

    where(query) {
      this.value = this.value.filter(item =>
        Object.keys(query).every(key =>
          query[key].test(item[key])
        )
      );
      return this;
    },

    orderBy(key, type) {
      this.value = this.value.sort((a, b) =>
        type === 'desc' ? b[key] - a[key] : a[key] - b[key]
      );
      return this;
    }
  };
}
```

---

## 使用示例（面试可直接跑）

```js
const result = find(data)
  .where({ title: /\d$/ })
  .orderBy('userId', 'desc');

console.log(result.value);
```

---
